<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gina Elite Nursing Care - Admin Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  :root {
    --primary:#2563eb;
    --success:#10b981;
    --danger:#ef4444;
    --bg:#f8fafc;
    --border:#e2e8f0;
    --radius:10px;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    font-family:"Segoe UI",sans-serif;
    background:var(--bg);
    color:#0f172a;
    display:flex;
    flex-direction:column;
    min-height:100vh;
  }
  header{
    background:var(--primary);
    color:white;
    padding:1rem;
    display:flex;
    justify-content:space-between;
    align-items:center;
    position:sticky;
    top:0;
    z-index:10;
  }
  header h1{font-size:1.2rem}
  .menu-toggle{
    display:none;
    background:none;
    border:none;
    color:white;
    font-size:1.4rem;
  }
  .sidebar{
    background:#fff;
    border-right:1px solid var(--border);
    padding:20px 10px;
    width:240px;
    position:fixed;
    height:100vh;
    top:0;
    left:0;
    transition:transform .3s ease;
    overflow-y:auto;
  }
  .sidebar h2{
    color:var(--primary);
    text-align:center;
    margin-bottom:20px;
  }
  .nav-link{
    display:flex;
    align-items:center;
    gap:10px;
    padding:10px 15px;
    text-decoration:none;
    color:#64748b;
    border-radius:var(--radius);
    margin-bottom:8px;
    transition:.3s;
  }
  .nav-link.active,.nav-link:hover{background:var(--primary);color:#fff}
  main{flex:1;margin-left:240px;padding:1rem}
  .stats{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:10px;
    margin-top:10px;
  }
  .card{
    background:white;
    padding:15px;
    border-radius:var(--radius);
    text-align:center;
    box-shadow:0 1px 3px rgba(0,0,0,0.1);
  }
  .card h3{font-size:.9rem;color:var(--primary)}
  .card p{font-size:1.4rem;font-weight:bold;margin-top:5px}
  .table-container{
    background:white;
    border-radius:var(--radius);
    overflow-x:auto;
    box-shadow:0 1px 3px rgba(0,0,0,0.05);
    margin-top:15px;
  }
  table{width:100%;border-collapse:collapse;font-size:.9rem}
  th,td{padding:10px;border-bottom:1px solid var(--border);text-align:left}
  th{background:#f1f5f9}
  tr:hover{background:#f9fafb}
  button{
    border:none;
    border-radius:6px;
    padding:6px 10px;
    cursor:pointer;
  }
  .btn-primary{background:var(--primary);color:white}
  .btn-danger{background:var(--danger);color:white}
  /* Modal */
  .modal-backdrop{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.6);
    justify-content:center;
    align-items:center;
    z-index:100;
  }
  .modal{
    background:white;
    padding:20px;
    border-radius:var(--radius);
    width:90%;
    max-width:400px;
  }
  .modal.show{display:flex}
  .form-group{margin-bottom:10px}
  label{font-weight:600;display:block;margin-bottom:4px}
  input,select{
    width:100%;
    padding:8px;
    border:1px solid var(--border);
    border-radius:6px;
  }
  .btn-group{display:flex;justify-content:flex-end;gap:8px}
  /* ðŸ“± MOBILE ADAPTATION */
  @media(max-width:768px){
    .sidebar{
      transform:translateX(-100%);
    }
    .sidebar.open{
      transform:translateX(0);
    }
    main{
      margin-left:0;
      padding-top:70px;
    }
    header h1{font-size:1rem}
    .menu-toggle{display:block}
    .stats{grid-template-columns:1fr 1fr}
    table{font-size:.85rem}
    th,td{padding:8px}
  }
</style>
</head>

<body>
<header>
  <button class="menu-toggle" onclick="toggleMenu()"><i class="fa fa-bars"></i></button>
  <h1>Gina Elite Admin</h1>
  <button class="btn-primary" onclick="refreshData()">âŸ³</button>
</header>

<aside class="sidebar" id="sidebar">
  <h2>Admin Menu</h2>
  <a href="#" class="nav-link active" data-section="dashboard"><i class="fa fa-chart-line"></i> Dashboard</a>
  <a href="#" class="nav-link" data-section="appointments"><i class="fa fa-calendar-check"></i> Appointments</a>
  <a href="#" class="nav-link" data-section="clients"><i class="fa fa-users"></i> Clients</a>
  <a href="#" class="nav-link" data-section="nurses"><i class="fa fa-user-nurse"></i> Nurses</a>
  <a href="https://ginaelitenursingcare.netlify.app/" class="nav-link"><i class="fa fa-globe"></i> Website</a>
</aside>

<main>
  <section id="dashboard" class="section active">
    <div class="stats">
      <div class="card"><h3>Total Clients</h3><p id="totalClients">--</p></div>
      <div class="card"><h3>Pending</h3><p id="pendingBookings">--</p></div>
      <div class="card"><h3>Confirmed</h3><p id="confirmedBookings">--</p></div>
      <div class="card"><h3>Nurses</h3><p id="nursesAssigned">--</p></div>
    </div>
  </section>

  <section id="appointments" class="section" style="display:none;">
    <h2>Appointments</h2>
    <div class="table-container">
      <table id="bookingsTable">
        <thead><tr><th>Client</th><th>Email</th><th>Service</th><th>Status</th><th>Nurse</th><th></th></tr></thead>
        <tbody><tr><td colspan="6">Loading...</td></tr></tbody>
      </table>
    </div>
  </section>

  <section id="clients" class="section" style="display:none;">
    <h2>Clients</h2>
    <div class="table-container">
      <table id="clientsTable">
        <thead><tr><th>Name</th><th>Email</th><th>Phone</th><th>Status</th></tr></thead>
        <tbody><tr><td colspan="4">Loading...</td></tr></tbody>
      </table>
    </div>
  </section>

  <section id="nurses" class="section" style="display:none;">
    <h2>Nurses</h2>
    <button class="btn-primary" onclick="addNurse()">+ Add Nurse</button>
    <div class="table-container">
      <table id="nursesTable">
        <thead><tr><th>Name</th><th>Specialty</th><th>Status</th></tr></thead>
        <tbody><tr><td colspan="3">Loading...</td></tr></tbody>
      </table>
    </div>
  </section>
</main>

<!-- Modal -->
<div class="modal-backdrop" id="assignModal">
  <div class="modal">
    <h2>Assign Nurse</h2>
    <form id="assignForm">
      <input type="hidden" id="bookingTimestamp">
      <div class="form-group"><label>Nurse</label><input id="assignedNurse" required></div>
      <div class="form-group"><label>Price Quote (XAF)</label><input type="number" id="priceQuote" required></div>
      <div class="form-group"><label>Payment Status</label>
        <select id="paymentStatus"><option>Paid</option><option>Unpaid</option><option>Deposit</option></select>
      </div>
      <div class="btn-group">
        <button type="button" class="btn-danger" onclick="closeModal()">Cancel</button>
        <button type="submit" class="btn-primary">Confirm</button>
      </div>
    </form>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/YOUR_DEPLOYED_SCRIPT_ID/exec";

function toggleMenu(){
  document.getElementById('sidebar').classList.toggle('open');
}
const links=document.querySelectorAll('.nav-link');
const sections=document.querySelectorAll('.section');
links.forEach(l=>{
  l.addEventListener('click',e=>{
    e.preventDefault();
    links.forEach(x=>x.classList.remove('active'));
    l.classList.add('active');
    const sec=l.dataset.section;
    sections.forEach(s=>s.style.display=s.id===sec?'block':'none');
    document.getElementById('sidebar').classList.remove('open');
  });
});

async function refreshData(){
  await loadDashboard();await loadClients();await loadBookings();await loadNurses();
}
async function loadDashboard(){
  const r=await fetch(`${SCRIPT_URL}?action=dashboard`);
  const d=await r.json();
  totalClients.textContent=d.totalClients;
  pendingBookings.textContent=d.pendingBookings;
  confirmedBookings.textContent=d.confirmedBookings;
  nursesAssigned.textContent=d.nursesAssigned;
}
async function loadClients(){
  const r=await fetch(`${SCRIPT_URL}?action=getClients`);
  const d=await r.json();
  clientsTable.querySelector('tbody').innerHTML=d.length?d.map(c=>`
  <tr><td>${c['Full Name']}</td><td>${c.Email}</td><td>${c.Phone}</td><td>${c.Status}</td></tr>`).join('')
  :'<tr><td colspan="4">No clients.</td></tr>';
}
async function loadBookings(){
  const r=await fetch(`${SCRIPT_URL}?action=getBookings`);
  const d=await r.json();
  bookingsTable.querySelector('tbody').innerHTML=d.length?d.map(b=>`
  <tr><td>${b['Client Name']}</td><td>${b.Email}</td><td>${b['Service Type']}</td>
  <td>${b.Status}</td><td>${b['Assigned Nurse']||'-'}</td>
  <td><button class="btn-primary" onclick="openAssignModal('${b.Timestamp}')">Assign</button></td></tr>`).join('')
  :'<tr><td colspan="6">No bookings.</td></tr>';
}
async function loadNurses(){
  const r=await fetch(`${SCRIPT_URL}?action=getNurses`);
  const d=await r.json();
  nursesTable.querySelector('tbody').innerHTML=d.length?d.map(n=>`
  <tr><td>${n.Name}</td><td>${n.Specialty}</td><td>${n.Status}</td></tr>`).join('')
  :'<tr><td colspan="3">No nurses.</td></tr>';
}
async function addNurse(){
  const name=prompt("Nurse name:");
  const specialty=prompt("Specialty:");
  if(!name||!specialty)return;
  const r=await fetch(SCRIPT_URL,{method:"POST",body:new URLSearchParams({action:"addNurse",name,specialty})});
  const res=await r.json();alert(res.message);loadNurses();
}
function openAssignModal(ts){
  bookingTimestamp.value=ts;
  assignModal.classList.add('show');
}
function closeModal(){assignModal.classList.remove('show');}
assignForm.addEventListener('submit',async e=>{
  e.preventDefault();
  const data=new URLSearchParams({
    action:"confirmBooking",
    timestamp:bookingTimestamp.value,
    nurse:assignedNurse.value,
    price:priceQuote.value,
    payment:paymentStatus.value
  });
  const r=await fetch(SCRIPT_URL,{method:"POST",body:data});
  const res=await r.json();
  alert(res.message);
  closeModal();refreshData();
});
refreshData();
</script>
</body>
</html>
